### Spark Delta таблицы:
- customers (id, full_name, city, registration_date)
- accounts (id, customer_id, account_type, balance, branch_id)
- branches (id, branch_name, city)
- transactions (id, account_id, amount, transaction_date, transaction_type)
- loans (id, customer_id, loan_amount, interest_rate, start_date, status)
- employees (id, full_name, branch_id, position, salary)


### Запросы:
1. Получить список клиентов и городов, в которых они зарегистрированы. 
2. Определить количество счетов каждого типа. 
3. Найти клиентов, у которых средний баланс по счетам превышает определенное значение.
4. Определить филиалы и количество клиентов, обслуживаемых в каждом из них.
5. Получить список клиентов и суммарный объём их транзакций. 
6. Найти клиентов, которые не имеют ни одного счёта. 
7. Определить сотрудников и количество клиентов, закрепленных за их филиалом.
8. Найти клиентов, оформивших более одного кредита.
9. Определить счета, по которым не было транзакций.
10. Получить список клиентов и их кредитов, отсортированных по сумме кредита.
11. Определить филиалы, в которых суммарный баланс счетов превышает заданное значение.
12. Найти клиентов, совершивших максимальную транзакцию в каждом месяце.
13. Определить клиентов, которые имеют счета в разных филиалах.
14. Получить список клиентов и их место в рейтинге по сумме транзакций внутри города.
15. Определить последовательность транзакций клиента с указанием текущей и следующей суммы.


### Explain:
EXPLAIN EXTENDED {query}